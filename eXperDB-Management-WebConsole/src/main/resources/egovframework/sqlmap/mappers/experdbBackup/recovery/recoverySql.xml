<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="experdbRecoverySql">

	<select id="getStorageList" parameterType="String" resultType="backupLocationInfoVO">
		SELECT distinct 
			  destinationlocation as "backupDestLocation"
		FROM jobhistory
		WHERE targetname  = #{ipadr}
	
	</select>

	<select id="getStorageType" parameterType="String" resultType="backupLocationInfoVO">
		SELECT 
		     type
		  FROM backuplocation
	  	 WHERE location = #{backupDestLocation}
	</select>
	
	<select id="getRecoveryDBList" resultType="restoreInfoVO">
		SELECT
		   	mac as guestMac
		  , ip as guestIp
		  , restoremachine_id as machineId
		  , subnetmask as guestSubnetmask
		  , gateway as guestGateway
		  , dns as guestDns  
		  , network as guestNetwork
		  FROM restoremachine
	</select>
	
	<insert id="recoveryDBInsert" parameterType="restoreInfoVO">
		INSERT INTO restoremachine
		(
			  mac
			, ip
			, subnetmask 
			, gateway 
			, dns 
			, network 
		) VALUES 
		(
			  #{guestMac}
			, #{guestIp}
			, #{guestSubnetmask}
			, #{guestGateway}
			, #{guestDns}
			, #{guestNetwork}
		)
	</insert>
	
	<delete id="recoveryDBDelete" parameterType="String">
		DELETE FROM restoremachine WHERE restoremachine_id = #{dbId}::numeric
	</delete>
	
</mapper>