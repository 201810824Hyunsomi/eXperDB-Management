<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cmmnSql">

	<select id="selectLoginUserList" parameterType="userVO" resultType="userVO">
		/**
	 	* Query ID : selectLoginUserList
	 	* Description : 로그인 사용자 조회
	 	* Author : 변승우
	 	**/
	 	
      SELECT 
				  USR_ID
				, USR_NM
				, PWD
				, BLN_NM
				, DEPT_NM
				, RSP_BSN_NM
				, PST_NM
				, AUT_ID
				, CPN
				, CASE WHEN (TO_TIMESTAMP(USR_EXPR_DT||'235959','YYYYMMDDHH24MISS') &lt; NOW())  THEN 'N' ELSE 'Y' END AS USR_EXPR_DT
				, USE_YN
				, FRST_REGR_ID
				, FRST_REG_DTM
				, LST_MDFR_ID
				, LST_MDF_DTM
      FROM T_USR_I
      WHERE 1=1	
      AND  USR_ID = #{usr_id}		
    </select>


	<select id="selectDbServerList" resultType="dbServerVO" parameterType="string">
			/**
		 	*  Query ID : selectDbServerList
		 	* Description : DB서버 리스트 조회
		 	* Author : 변승우
		 	**/
		 	
		  SELECT
	      		(ROW_NUMBER() OVER()) AS ROWNUM
				, (ROW_NUMBER() OVER()) AS IDX
				, A.DB_SVR_ID
				, A.DB_SVR_NM
				, A.IPADR
				, A.PORTNO
				, A.DFT_DB_NM
				, A.SVR_SPR_USR_ID
				, A.SVR_SPR_SCM_PWD
				, A.FRST_REGR_ID
				, A.FRST_REG_DTM
				, A.LST_MDFR_ID
				, A.LST_MDF_DTM
	      FROM(      
	          SELECT 
	                 DB_SVR_ID
	                , DB_SVR_NM
	                , IPADR
	                , PORTNO
	                , DFT_DB_NM
	                , SVR_SPR_USR_ID
	                , SVR_SPR_SCM_PWD
	                , FRST_REGR_ID
	                , FRST_REG_DTM
	                , LST_MDFR_ID
	                , LST_MDF_DTM
	          FROM T_DBSVR_I	
	          WHERE 1 = 1         
		      AND DB_SVR_NM = #{db_svr_nm}
	          ORDER BY DB_SVR_ID
	      ) A		
    </select>


	<select id="selectServerInfo" resultType="dbServerVO" parameterType="dbServerVO">
				/**
		 	*  Query ID : selectDbServerList
		 	* Description : DB서버 정보 조회
		 	* Author : 박태혁
		 	**/
	          SELECT 
	                 DB_SVR_ID
	                , DB_SVR_NM
	                , IPADR
	                , PORTNO
	                , DFT_DB_NM
	                , PGHOME_PTH
	                , PGDATA_PTH
	                , SVR_SPR_USR_ID
	                , SVR_SPR_SCM_PWD
	                , FRST_REGR_ID
	                , FRST_REG_DTM
	                , LST_MDFR_ID
	                , LST_MDF_DTM
	          FROM T_DBSVR_I
	          WHERE
	          	DB_SVR_ID = #{db_svr_id}
	</select>
	
	<select id="selectAgentInfo" resultType="agentInfoVO" parameterType="agentInfoVO">
			/**
		 	*  Query ID : selectAgentInfo
		 	* Description : Agent 정보 조회
		 	* Author : 박태혁
		 	**/
		 	SELECT
				AGT_SN
				, IPADR
				, SOCKET_PORT
				, AGT_CNDT_CD
				, STRT_DTM
				, ISTCNF_YN
				, FRST_REGR_ID
				, FRST_REG_DTM
				, LST_MDFR_ID
				, LST_MDF_DTM
			FROM  T_AGTCNDT_I
			WHERE
				IPADR = #{IPADR}
			LIMIT 1
	</select>
</mapper>
