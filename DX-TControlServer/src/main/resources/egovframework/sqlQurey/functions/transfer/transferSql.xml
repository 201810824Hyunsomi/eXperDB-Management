<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="transferSql">
	<typeAlias alias="ConnectorVO" type="com.k4m.dx.tcontrol.functions.transfer.service.ConnectorVO"/>
	
		<select id="selectConnectorRegister" resultClass="ConnectorVO">
		/**
	 	* Query ID : selectConnectorRegister
	 	* Description : Connector 조회
	 	* Author : 김주영
	 	**/
		SELECT
		  (ROW_NUMBER() OVER()) AS ROWNUM
		, (ROW_NUMBER() OVER()) AS IDX
		, A.CNR_ID
		, A.CNR_NM
		, A.CNR_IPADR
		, A.CNR_PORTNO
		, A.CNR_CNN_TP_CD
		, A.FRST_REGR_ID
		, A.FRST_REG_DTM
		, A.LST_MDFR_ID
		, A.LST_MDF_DTM
		FROM(			
			SELECT 
			  CNR_ID
			, CNR_NM
			, CNR_IPADR
			, CNR_PORTNO
			, CNR_CNN_TP_CD
			, FRST_REGR_ID
			, to_char(T_CNR_I.FRST_REG_DTM,'YYYY-MM-DD HH:mm:ss')FRST_REG_DTM
			, LST_MDFR_ID
			, to_char(T_CNR_I.LST_MDF_DTM,'YYYY-MM-DD HH:mm:ss')LST_MDF_DTM
			FROM T_CNR_I
			WHERE 1=1	
				<isNotEmpty property="cnr_nm">
				AND CNR_NM LIKE #cnr_nm#
				</isNotEmpty>
				<isNotEmpty property="cnr_ipadr">
				AND CNR_IPADR LIKE #cnr_ipadr#
				</isNotEmpty>
			ORDER BY LST_MDF_DTM DESC
		)A		
    	</select>
    
		<select id="selectDetailConnectorRegister" resultClass="ConnectorVO">
		/**
	 	* Query ID : selectDetailConnectorRegister
	 	* Description : Connector 상세 조회
	 	* Author : 김주영
	 	**/
	 	SELECT 
	 	  CNR_ID
		, CNR_NM
		, CNR_IPADR
		, CNR_PORTNO
		, CNR_CNN_TP_CD
		, FRST_REGR_ID
		, FRST_REG_DTM
		, LST_MDFR_ID
		, LST_MDF_DTM
		FROM T_CNR_I
		WHERE cnr_id = #cnr_id#
	 	</select>
	 
		<delete id="deleteConnectorRegister" parameterClass="int">
		/**
		* Query ID : deleteConnectorRegister
		* Description : Connector 삭제
		* Author : 김주영
		**/
		DELETE FROM T_CNR_I
		WHERE cnr_id=#cnr_id#
		</delete>
		
		<insert id="insertConnectorRegister" parameterClass="ConnectorVO">
		/**
		* Query ID : insertConnectorRegister
		* Description : Connector 등록
		* Author : 김주영
		**/		
		INSERT INTO T_CNR_I(
		  CNR_ID
		, CNR_NM
		, CNR_IPADR
		, CNR_PORTNO
		, CNR_CNN_TP_CD
		, FRST_REGR_ID
		, FRST_REG_DTM
		, LST_MDFR_ID
		, LST_MDF_DTM
		) 
		VALUES(         
		  nextval('q_cnr_i_01')
		, #cnr_nm#
		, #cnr_ipadr#
		, #cnr_portno#
		, #cnr_cnn_tp_cd#
		, #frst_regr_id#
		, clock_timestamp()
		, #lst_mdfr_id#
		, clock_timestamp()
		)
		</insert>
		
		<update id="updateConnectorRegister" parameterClass="ConnectorVO">
		/**
		* Query ID : updateConnectorRegister
		* Description : Connector 업데이트
		* Author : 김주영
		**/	
		UPDATE T_CNR_I
		SET
		  CNR_NM = #cnr_nm#
		, CNR_IPADR = #cnr_ipadr#
		, CNR_PORTNO =#cnr_portno#
		, CNR_CNN_TP_CD =#cnr_cnn_tp_cd#
		, LST_MDFR_ID =#lst_mdfr_id#
		, LST_MDF_DTM = clock_timestamp()
		WHERE CNR_ID = #cnr_id#			
		</update>
</sqlMap>